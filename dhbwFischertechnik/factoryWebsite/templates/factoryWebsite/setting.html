{% extends 'factoryWebsite/main.html' %}
{% load static %}
{% block content %}
<h1>Bitte geben Sie den aktuellen Lagerbestand ein.</h1>
<form id="form">
    {% csrf_token %}
    <table class="table text-center">
      <tr>
        <td>
            <label>
                <select id="storage0">
                    <option value="w">Weiß</option>
                    <option value="e">Leere Kiste</option>
                    <option value="x">Keine Kiste</option>
                </select>
            </label>
        </td>
        <td>
            <label>
                <select id="storage1">
                    <option value="w">Weiß</option>
                    <option value="e">Leere Kiste</option>
                    <option value="x">Keine Kiste</option>
                </select>
            </label>
        </td>
        <td>
            <label>
                <select id="storage2">
                    <option value="w">Weiß</option>
                    <option value="e">Leere Kiste</option>
                    <option value="x">Keine Kiste</option>
                </select>
            </label>
        </td>
      </tr>
      <tr>
        <td>
            <label>
                <select id="storage3">
                    <option value="r">Rot</option>
                    <option value="e">Leere Kiste</option>
                    <option value="x">Keine Kiste</option>
                </select>
            </label>
        </td>
        <td>
            <label>
                <select id="storage4">
                    <option value="r">Rot</option>
                    <option value="e">Leere Kiste</option>
                    <option value="x">Keine Kiste</option>
                </select>
            </label>
        </td>
        <td>
            <label>
                <select id="storage5">
                    <option value="r">Rot</option>
                    <option value="e">Leere Kiste</option>
                    <option value="x">Keine Kiste</option>
                </select>
            </label>
        </td>
      </tr>
      <tr>
        <td>
            <label>
                <select id="storage6">
                    <option value="b">Blau</option>
                    <option value="e">Leere Kiste</option>
                    <option value="x">Keine Kiste</option>
                </select>
            </label>
        </td>
        <td>
            <label>
                <select id="storage7">
                    <option value="b">Blau</option>
                    <option value="e">Leere Kiste</option>
                    <option value="x">Keine Kiste</option>
                </select>
            </label>
        </td>
        <td>
            <label>
                <select id="storage8">
                    <option value="b">Blau</option>
                    <option value="e">Leere Kiste</option>
                    <option value="x">Keine Kiste</option>
                </select>
            </label>
        </td>
      </tr>
      <tr>
        <td>
        </td>
        <td>
            <button id="send-to-factory">Lagerbestand aktualisieren</button>
        </td>
        <td>
        </td>
      </tr>
    </table>
</form>

<script type="text/javascript">
    document.getElementById('cart-symbol').classList.add("hidden");

    csrftoken = form.getElementsByTagName("input")[0].value

    document.getElementById('send-to-factory').addEventListener('click', function (){
        sendToFactory()
    })

    function sendToFactory(){
        var storageString = "" + document.getElementById('storage0').value +
            document.getElementById('storage1').value +
            document.getElementById('storage2').value +
            document.getElementById('storage3').value +
            document.getElementById('storage4').value +
            document.getElementById('storage5').value +
            document.getElementById('storage6').value +
            document.getElementById('storage7').value +
            document.getElementById('storage8').value

        const url = "/setting/sendToFactory/";
        fetch(url, {
            method:'POST',
            headers:{
                'Content-Type':'application/json',
                'X-CSRFToken':csrftoken,
            },
            body: storageString,

        })
        .then((response) => response.json())
        .then(() => {
            alert('Lagerbestand erfolgreich aktualisiert');
            window.location.pathname = '/setting/';
        })
    }
</script>

{% endblock content %}