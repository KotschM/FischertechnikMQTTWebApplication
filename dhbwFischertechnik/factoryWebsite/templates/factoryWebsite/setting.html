{% extends 'factoryWebsite/main.html' %}
{% load static %}
{% block content %}
<h1>Bitte geben Sie den aktuellen Lagerbestand ein.</h1>
<form id="form">
    {% csrf_token %}
    <table class="table text-center">
      <tr>
        <td>
            <label>
                <select id="storage0">
                    <option value="1">Weiß</option>
                    <option value="0">Leere Kiste</option>
                    <option value="-1">Keine Kiste</option>
                </select>
            </label>
        </td>
        <td>
            <label>
                <select id="storage1">
                    <option value="1">Weiß</option>
                    <option value="0">Leere Kiste</option>
                    <option value="-1">Keine Kiste</option>
                </select>
            </label>
        </td>
        <td>
            <label>
                <select id="storage2">
                    <option value="1">Weiß</option>
                    <option value="0">Leere Kiste</option>
                    <option value="-1">Keine Kiste</option>
                </select>
            </label>
        </td>
      </tr>
      <tr>
        <td>
            <label>
                <select id="storage3">
                    <option value="2">Rot</option>
                    <option value="0">Leere Kiste</option>
                    <option value="-1">Keine Kiste</option>
                </select>
            </label>
        </td>
        <td>
            <label>
                <select id="storage4">
                    <option value="2">Rot</option>
                    <option value="0">Leere Kiste</option>
                    <option value="-1">Keine Kiste</option>
                </select>
            </label>
        </td>
        <td>
            <label>
                <select id="storage5">
                    <option value="2">Rot</option>
                    <option value="0">Leere Kiste</option>
                    <option value="-1">Keine Kiste</option>
                </select>
            </label>
        </td>
      </tr>
      <tr>
        <td>
            <label>
                <select id="storage6">
                    <option value="3">Blau</option>
                    <option value="0">Leere Kiste</option>
                    <option value="-1">Keine Kiste</option>
                </select>
            </label>
        </td>
        <td>
            <label>
                <select id="storage7">
                    <option value="3">Blau</option>
                    <option value="0">Leere Kiste</option>
                    <option value="-1">Keine Kiste</option>
                </select>
            </label>
        </td>
        <td>
            <label>
                <select id="storage8">
                    <option value="3">Blau</option>
                    <option value="0">Leere Kiste</option>
                    <option value="-1">Keine Kiste</option>
                </select>
            </label>
        </td>
      </tr>
      <tr>
        <td>
        </td>
        <td>
            <button id="send-to-factory">Lagerbestand aktualisieren</button>
        </td>
        <td>
        </td>
      </tr>
    </table>
</form>

<script type="text/javascript">
    document.getElementById('cart-symbol').classList.add("hidden");

    csrftoken = form.getElementsByTagName("input")[0].value

    document.getElementById('send-to-factory').addEventListener('click', function (){
        sendToFactory()
    })

    function sendToFactory(){
        var storageData = {
            'storage0': document.getElementById('storage0').value,
            'storage1': document.getElementById('storage1').value,
            'storage2': document.getElementById('storage2').value,
            'storage3': document.getElementById('storage3').value,
            'storage4': document.getElementById('storage4').value,
            'storage5': document.getElementById('storage5').value,
            'storage6': document.getElementById('storage6').value,
            'storage7': document.getElementById('storage7').value,
            'storage8': document.getElementById('storage8').value,
        }

        const url = "/setting/sendToFactory/";
        fetch(url, {
            method:'POST',
            headers:{
                'Content-Type':'application/json',
                'X-CSRFToken':csrftoken,
            },
            body:JSON.stringify({'form':storageData}),

        })
        .then((response) => response.json())
        .then(() => {
            alert('Lagerbestand erfolgreich aktualisiert');
            window.location.pathname = '/setting/';
        })
    }
</script>

{% endblock content %}